\ProvidesPackage{preamble}

% General packages
\usepackage{import}
\usepackage{float}
\usepackage[labelfont=bf]{caption}
\usepackage{booktabs}
\usepackage{url}
\usepackage{appendix}
\usepackage{parskip}
\usepackage{setspace}
\setlength\parindent{0pt}
\usepackage[section]{placeins}
\usepackage[hyperfootnotes=false]{hyperref}
\usepackage[multiple, hang, bottom]{footmisc}
\usepackage{footnotebackref}
\usepackage{bookmark}

%Algorithm environment
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\algrenewcommand\algorithmicdo{\textbf{:}}
\algrenewcommand\algorithmicthen{\textbf{:}}
\algnewcommand{\Statey}[0]{\Statex \hskip \ALG@tlm }

% Physics packages
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{slashed}
\usepackage{physics}

% Tikz packages
\usepackage{tikz-feynman}
\tikzfeynmanset{compat=1.1.0}

%Abstract
\renewenvironment{abstract}
{\begin{quote}
    \noindent \rule{\linewidth}{.5pt}\par{\bfseries \abstractname.}}
    {\medskip\noindent \par\rule{\linewidth}{.5pt}
    \end{quote}
}

% Appendix
\renewcommand{\appendixname}{Appendix} 
\appendixtitleon    % puts \appendixname before each appendix title
\appendixtitletocon % puts \appendixname before each TOC entry
\let\origappendix\appendix % save the existing appendix command
%\renewcommand\appendix{\clearpage\pagenumbering{Roman}\origappendix} #Roman numerals for appendix

% Chapters - rename "part" to "chapter"
\renewcommand{\partname}{Chapter}
\newcommand{\chapter}{\part}

% Chapters - remove some from TOC,
\let\oldcontentsline\contentsline
\newcommand{\nopagecontentsline}[3]{\oldcontentsline{#1}{#2}{}}

% Graphics packages
\usepackage{graphicx}
\usepackage[margin=1in, a4paper]{geometry}
\usepackage{xsim,tcolorbox}
\usepackage[framemethod=default]{mdframed}

% Other
\graphicspath{ {./images/} }
\setstretch{1.125} %changes line spacing

% Referencing
\def\equationautorefname~#1\null{Eqn.~(#1)\null}
\def\figureautorefname~#1\null{Figure~#1\null}
\def\partautorefname~#1\null{Chapter~#1\null}
\def\sectionautorefname~#1\null{Section~#1\null}
\def\subsectionautorefname~#1\null{Section~#1\null}
\def\algorithmautorefname~#1\null{Algorithm~#1\null}

% Bibtex
\usepackage[backend=biber, giveninits=true, sorting=none, isbn=false, style=numeric-comp]{biblatex}
\addbibresource{refs.bib}
\AtEveryBibitem{%
  \ifboolexpr
    {test {\ifentrytype{article}}
    or
    test {\ifentrytype{book}}
    or
    test {\ifentrytype{inbook}}
    or
    test {\ifentrytype{inproceedings}}
    }
    {\clearfield{url}}
    {}%
}
\setlength\bibitemsep{0.3\baselineskip}

% Numbering and enumerate format
\numberwithin{equation}{section}
\numberwithin{figure}{section}
\numberwithin{table}{section}
\renewcommand{\thesection}{\arabic{section}}
\usepackage[shortlabels]{enumitem}

% Define Note-environment
\newenvironment{note}[1]{%
\mdfsetup{%
    frametitle={\colorbox{white}{\,Note:\,#1}},
    frametitleaboveskip=-\ht\strutbox,
    frametitlealignment=\raggedright
    }%
\begin{mdframed}[
    linecolor=lightgray,linewidth=1pt,%
    leftmargin=1cm,rightmargin=1cm,]
}{\end{mdframed}}

% Notation
\let\oldhat\hat
\renewcommand{\vec}[1]{\mathbf{#1}}
\DeclareMathOperator\erfc{erfc}

% Custom commands.
\newcommand{\lit}[1]{\footnote{Literature warning: #1}}
\newcommand{\kty}[1]{\textcolor{red}{\textit{kommentar: }Konrad: \textit{#1}}}
\newcommand{\krs}[1]{\textcolor{red}{\textit{kommentar: }#1}}
\newcommand{\elab}[0]{\textcolor{blue}{\newline Elaborate...}}

\newcommand{\nocontentsline}[3]{}
\newcommand{\tocless}[2]{\bgroup\let\addcontentsline=\nocontentsline#1{#2}\egroup}